var orderConfModel=new Vue({el:"#model-orderConf",data:{orderInfo:"",orderId:0,userBaseInfo:"",payMethod:1,payLine:0,payLineMap:[{bankcode:"006",bankName:"宝付支付"},{bankcode:"005",bankName:"富友支付"}],payPwd:"",payLock:!1},methods:{getOrderInfo:function(){var e=this;return headerModel.isLogin?($("#loader").fadeIn(300),void this.$http.get(headerModel.api+"/Order/GetOrder?orderid="+e.orderId).then(function(o){$("#loader").fadeOut(300),e.orderInfo=o.data})):void DGDTOOLS.check._isLogin()},getUserBaseInfo:function(e){var o=this;return o.userBaseInfo?void(o.payMethod=e):(headerModel.loading=!0,void $.ajax({url:headerModel.api+"/MyCenter/UserBaseInfo",data:{token:headerModel.token},type:"post",success:function(d){o.payMethod=e,headerModel.loading=!1,200==d.resultid?o.userBaseInfo=d:console.log(d.message)},error:function(e){console.error(e.status+":"+e.responseText)}}))},toggleTab:function(e){0==e||3==e?this.getUserBaseInfo(e):this.payMethod=e},buyNow:function(){var e=this,o=e.orderInfo.project.State;return"1"==o?void DGDTOOLS.tip._tip("当前项目还处于预热中"):"3"==o?void DGDTOOLS.tip._tip("当前项目融资已完成"):"0"==e.orderInfo.project.OnlineState?void DGDTOOLS.tip._tip("当前项目未上架或已下架"):"已支付"==e.orderInfo.order.PayStatus?void DGDTOOLS.tip._tip("该订单已支付"):(""!=e.payPwd||headerModel.isMobile||DGDTOOLS.tip._tip("请输入支付密码"),void(e.payLock||(e.payLock=!0,headerModel.loading=!0,1==e.payMethod?headerModel.isMobile?(console.log("移动端支付"),this.$http.get(headerModel.api+"/Pay/QueryCard?token="+headerModel.token).then(function(o){"1"===o.data.retCode?(headerModel.loading=!1,e.payLock=!1,DGDTOOLS.tip._tip(o.data.retMsg)):(headerModel.loading=!1,e.payLock=!1,DGDTOOLS.tip._tip(o.data.retMsg,function(){window.location.href="../MyCenter/bindCard?orderId="+e.orderId}))})):$.ajax({url:headerModel.api+"/Pay/PayForPC",data:{Token:headerModel.token,Amount:e.orderInfo.order.PayAmount,AssociatedBank:e.payLineMap[e.payLine].bankName,bankcode:e.payLineMap[e.payLine].bankcode,orderid:e.orderId,payPassword:$.md5($.md5(e.payPwd))},type:"post",success:function(o){headerModel.loading=!1,e.payLock=!1,200==o.resultid?(document.body.innerHTML=o.HTML,0==e.payLine?document.getElementById("pay").submit():document.getElementById("form1").submit()):DGDTOOLS.tip._tip(o.message)},error:function(o){headerModel.loading=!1,e.payLock=!1,console.error(o.status+":"+o.responseText)}}):$.ajax({url:headerModel.api+"/Order/PostOrder",data:{token:headerModel.token,orderid:e.orderId,PayPassworld:$.md5($.md5(e.payPwd)),paytype:e.payMethod,PayPlat:0},type:"post",success:function(o){headerModel.loading=!1,e.payLock=!1,200==o.resultid?window.location.href="complete?orderId="+e.orderId:DGDTOOLS.tip._tip(o.message)},error:function(o){headerModel.loading=!1,e.payLock=!1,console.error(o.status+":"+o.responseText)}}))))}},computed:{},mounted:function(){this.orderId=window.location.search.split("orderId=")[1]||0,this.orderId||(window.location.href="../project/index.html"),this.getOrderInfo()}});