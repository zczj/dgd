var projectDetail=new Vue({el:"#detail",data:{TimesRotation:["种子期","天使期","pre-A轮","A轮","B轮","C轮"],tabShow:0,detailNavCur:0,detailNav:!1,shareShow:!0,isFirstTab:!0,loading:!1,wechatShare:!1,webShare:!1,detail:"",followPersonList:[],projectQAList:{},proId:""},methods:{toggleTab:function(t){this.tabShow=t,1===t?this.getProjectQAList():2===t&&this.getFollowPerson()},getProjectDetail:function(){$("#loader").fadeIn("300");var t=headerModel.api+"/ZhongChou/Detail/"+this.proId+"?token=1";this.$http.get(t).then(function(t){t.data&&(this.detail=t.data,this.$nextTick(function(){this.share(),this.getPicWidth(),this.scroll(),this.resize()}),$("#loader").fadeOut("300"))})},getFollowPerson:function(){this.followPersonList=this.detail.FollowPerson},getProjectQAList:function(){if(!this.isFirstTab)return!1;headerModel.loading=!0;var t=headerModel.api+"/ZhongChou/ProjectQAList?projectid="+this.proId;this.$http.get(t).then(function(t){this.projectQAList=t.data.list.reverse(),headerModel.loading=!1,this.isFirstTab=!1})},AddProjectQA:function(){var t=this,e=t.$refs.qaText;if(!headerModel.isLogin)return DGDTOOLS.check._isLogin(),!1;if(""===e.value)return $.dialog({type:"warning",message:"请填写留言内容",delay:2e3,maskClose:!0,effect:!0}),this.$refs.qaText.focus(),!1;headerModel.loading=!0;var i=headerModel.api+"/ZhongChou/AddProjectQA";$.ajax({url:i,method:"POST",data:{ProjectID:t.proId,Content:e.value,Token:headerModel.token,ParentID:0}}).done(function(i){e.value="",t.isFirstTab=!0,t.getProjectQAList(),headerModel.loading=!1})},scroll:function(){var t=this.$refs.sidebar,e=headerModel.$refs.header.offsetHeight,i=document.body.clientWidth||document.documentElement.clientWidth;i>=900?(this.navigatorFn(),this.navigatorPos(),this.sidebarPos()):(t.style.width="100%",t.style.position="static"),t.style.width=t.parentNode.offsetWidth+"px","fixed"==t.style.position&&(t.style.top=e+"px")},navigatorFn:function(){$(window).scroll(function(){var t=$(".item-desc").find(".content-item"),e=$(".detail-nav"),i=$(document).scrollTop(),o="",n=e.find(".current");t.each(function(){var t=$(this);return i>t.offset().top-200&&void(o="#"+t.attr("id"))}),o&&n.attr("href")!==o&&(n.removeClass("current"),e.find("[href="+o+"]").addClass("current"))})},navigatorPos:function(){var t=this;$(window).scroll(function(){var e=(t.$refs.detailNav,t.$refs.container),i=$(document).scrollTop();i>e.offsetTop-400?t.detailNav=!0:t.detailNav=!1})},sidebarPos:function(){var t=this;$(window).scroll(function(){var e=t.$refs.sidebar,i=t.$refs.container,o=$(document).scrollTop(),n=headerModel.$refs.header.offsetHeight,r=document.body.clientWidth||document.documentElement.clientWidth;r>=900&&(i.style.minHeight=e.offsetHeight+"px",i.offsetTop-n<=o?$(e).css({position:"fixed",width:$(e).parent().width(),top:n}):$(e).css({position:"relative",top:0}))})},getPicWidth:function(){var t=$(".item-desc img");t.each(function(){$(this).width()>$(document).width()&&$(this).parent("p").css("overflow-x","auto")})},share:function(){DGDTOOLS.Ev._share(".iShare1")},weChatShare:function(){if(DGDTOOLS.check._isWeixin())this.wechatShare=!0;else{this.webShare=!0;var t=DGDTOOLS.Ev._loadJS("/skin/js/project/qrcode.min.js");if(null==t)return void setTimeout(function(){DGDTOOLS.Ev._createQrcode(document.querySelector("#canvas"))},40);t.onload=function(){DGDTOOLS.Ev._createQrcode(document.querySelector("#canvas"))}}},resize:function(){var t=this;window.onresize=function(){t.scroll()}}},computed:{totalFollowPerson:function(){if(this.detail)return this.detail.FollowPerson.length}},mounted:function(){var t=this;return this.proId=window.location.search.split("id=")[1]||0,0==this.proId?(window.location.href="./index.html",!1):void t.getProjectDetail()}});